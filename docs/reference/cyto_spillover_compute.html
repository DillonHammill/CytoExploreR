<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute Spillover Matrix — cyto_spillover_compute • CytoExploreR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute Spillover Matrix — cyto_spillover_compute" />
<meta property="og:description" content="cyto_spillover_compute uses the method described by Bagwell &amp;amp; Adams
1993 to automatically calculate the fluorescent spillover matrix using single
stain compensation controls." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CytoExploreR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CytoExploreR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CytoExploreR-Compensation.html">Compensation of Fluorescent Spillover</a>
    </li>
    <li>
      <a href="../articles/CytoExploreR-Manual-Gating.html">Manual Gating</a>
    </li>
    <li>
      <a href="../articles/CytoExploreR-Transformations.html">Data Transformations</a>
    </li>
    <li>
      <a href="../articles/CytoExploreR-Visualisations.html">Viualise Cytometry Data with cyto_plot()</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/DillonHammill/CytoExploreR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Spillover Matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/DillonHammill/CytoExploreR/blob/master/R/cyto_spillover_compute.R'><code>R/cyto_spillover_compute.R</code></a></small>
    <div class="hidden name"><code>cyto_spillover_compute.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>cyto_spillover_compute</code> uses the method described by Bagwell &amp; Adams
1993 to automatically calculate the fluorescent spillover matrix using single
stain compensation controls.</p>
    </div>

    <pre class="usage"><span class='fu'>cyto_spillover_compute</span>(
  <span class='no'>x</span>,
  <span class='kw'>parent</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>axes_trans</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>channel_match</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>spillover</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>axes_limits</span> <span class='kw'>=</span> <span class='st'>"machine"</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>object of class <code><a href='https://rdrr.io/pkg/flowCore/man/flowSet-class.html'>flowSet</a></code> or
<code><a href='https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html'>GatingSet</a></code> containing
transformed and gated compensation controls.</p></td>
    </tr>
    <tr>
      <th>parent</th>
      <td><p>name of the population to use for the spillover calculation
when a GatingSet object is supplied, set to the last node of the GatingSet
by default (e.g. "Single Cells"). For greater flexibility, users can
specify a parent population for each control, which will be extracted for
the spillover calculation (e.g. Lymphocytes for CD4 APC or Myeloid Cells
for CD11b FITC). The parent populations for each control can also be
specified in a <code>parent</code> column in the channel match CSV file or in
<code>cyto_details</code>.</p></td>
    </tr>
    <tr>
      <th>axes_trans</th>
      <td><p>object of class
<code><a href='https://rdrr.io/pkg/flowWorkspace/man/transformerList.html'>transformerList</a></code> generated by a
<code>cyto_transformer</code> which contains the transformer definitions used to
transform the data. Transformer definitions are only required when a
flowSet object is supplied.</p></td>
    </tr>
    <tr>
      <th>channel_match</th>
      <td><p>name of csv file to associate a fluorescent channel with
each of the compensation controls. The <code>channel_match</code> file should
contain a "name" column with the names of the compensation controls and a
"channel" column to associate a fluorescent channel with each compensation
control. Users need not generate this file by hand as it will be created
following the channel selection process. This information can also be added
directly to the samples using <code>cyto_details_edit</code>.</p></td>
    </tr>
    <tr>
      <th>spillover</th>
      <td><p>name of the output spillover csv file, set to
<code>"Spillover-Matrix.csv"</code> by default.</p></td>
    </tr>
    <tr>
      <th>axes_limits</th>
      <td><p>options include <code>"auto"</code>, <code>"data"</code> or
<code>"machine"</code> to use optimised, data or machine limits respectively. Set
to <code>"machine"</code> by default to use entire axes ranges. Fine control over
axes limits can be obtained by altering the <code>xlim</code> and <code>ylim</code>
arguments.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to <code><a href='cyto_plot.html'>cyto_plot</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>spillover matrix and write spillover matrix to csv file named in
  accordance with <code>spillover</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>cyto_spillover_compute</code> supports spillover matrix calculation for both
internal or universal unstained reference populations based on channel
selection. <code>cyto_spillover_compute</code> expects the fluorescent channels of
the samples to be pre-transformed. Attempts will be made to transform the
data internally (using biexponential transformations) if it looks like the
data has not been transformed.</p>
<p><code>cyto_spillover_compute</code> begins by the user selecting which fluorescent
channel is associated with each compensation control from a dropdown menu.
The results of these selections are saved to a csv file called
"Compensation-Channels.csv" which can be passed to the <code>channel_match</code>
argument on subsequent runs to bypass the channel selection process. In cases
where multiple controls are supplied for the same channel, the control with
the greatest signal in the designated channel (MedFI) will be used for the
calculation.</p>
<p>Following channel selection, <code>cyto_spillover_compute</code> runs through each
compensation control and plots the density distribution in the associated
channel. If a universal "Unstained" compensation control is supplied, the
unstained compensation control will be overlaid onto the plot as a reference
for gating. Users can then gate the positive signal for spillover calculation
using an interval gate. If no universal unstained compensation control is
supplied, users are expected to gate the negative and then the positive
signal for each compensation control.</p>
<p>The percentage spillover is calculated based on the median fluorescent
intensities (MedFI) of the positive populations relative to that of the
reference negative population(s). The calculated spillover matrix is returned
and written to a named csv file for future use.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>C. B. Bagwell \&amp; E. G. Adams (1993). Fluorescence spectral
  overlap compensation for any number of flow cytometry parameters. in:
  Annals of the New York Academy of Sciences, 677:167-184.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='cyto_spillover_edit.html'>cyto_spillover_edit</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>CytoExploreRData</span>)

<span class='co'># Bypass directory check for external files</span>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='st'>"CytoExploreR_wd_check"</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># Load in compensation controls</span>
<span class='no'>fs</span> <span class='kw'>&lt;-</span> <span class='no'>Compensation</span>
<span class='no'>gs</span> <span class='kw'>&lt;-</span> <span class='fu'>GatingSet</span>(<span class='no'>Compensation</span>)

<span class='co'># Gate using cyto_gate_draw</span>
<span class='no'>gt</span> <span class='kw'>&lt;-</span> <span class='no'>Compensation_gatingTemplate</span>
<span class='fu'><a href='cyto_gatingTemplate_apply.html'>cyto_gatingTemplate_apply</a></span>(<span class='no'>gs</span>, <span class='no'>gt</span>)

<span class='co'># Channel match fille</span>
<span class='no'>cmfile</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>,
  <span class='st'>"Compensation-Channels.csv"</span>,
  <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"CytoExploreRData"</span>
)

<span class='co'># Compute fluorescent spillover matrix</span>
<span class='no'>spill</span> <span class='kw'>&lt;-</span> <span class='fu'>cyto_spillover_compute</span>(<span class='fu'><a href='cyto_extract.html'>cyto_extract</a></span>(<span class='no'>gs</span>, <span class='st'>"Single Cells"</span>),
  <span class='kw'>channel_match</span> <span class='kw'>=</span> <span class='no'>cmfile</span>,
  <span class='kw'>spillover</span> <span class='kw'>=</span> <span class='st'>"Example-spillover.csv"</span>
)

<span class='co'># Compensate samples</span>
<span class='no'>gs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='cyto_compensate.html'>cyto_compensate</a></span>(<span class='no'>gs</span>, <span class='no'>spill</span>)

<span class='co'># Return CytoExploreR_wd_check to default</span>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='st'>"CytoExploreR_wd_check"</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dillon Hammill.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


