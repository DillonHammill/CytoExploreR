<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started • CytoExploreR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<meta property="og:description" content="CytoExploreR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CytoExploreR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CytoExploreR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CytoExploreR-Compensation.html">Compensation of Fluorescent Spillover</a>
    </li>
    <li>
      <a href="../articles/CytoExploreR-Manual-Gating.html">Manual Gating</a>
    </li>
    <li>
      <a href="../articles/CytoExploreR-Transformations.html">Data Transformations</a>
    </li>
    <li>
      <a href="../articles/CytoExploreR-Visualisations.html">Visualise Cytometry Data with cyto_plot()</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DillonHammill/CytoExploreR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="CytoExploreR_files/header-attrs-2.5/header-attrs.js"></script><link href="CytoExploreR_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="CytoExploreR_files/anchor-sections-1.0/anchor-sections.js"></script><script src="CytoExploreR_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><link href="CytoExploreR_files/vis-4.20.1/vis.css" rel="stylesheet">
<script src="CytoExploreR_files/vis-4.20.1/vis.min.js"></script><script src="CytoExploreR_files/visNetwork-binding-2.0.9/visNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started</h1>
                        <h4 class="author">Dillon Hammill</h4>
            
            <h4 class="date">2021-04-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DillonHammill/CytoExploreR/blob/master/vignettes/CytoExploreR.Rmd"><code>vignettes/CytoExploreR.Rmd</code></a></small>
      <div class="hidden name"><code>CytoExploreR.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<div style="line-height: 1.8em;">
<p>The full capabilities of <strong>CytoExploreR</strong> will be documented in series of vignettes which address specific aspects of the data analysis pipeline. Before we dive into the details, let’s walk through the basic steps to analyse some <em>in vitro</em> T cell activation data using <strong>CytoExploreR</strong>.</p>
<p>This <strong>Activation</strong> dataset and associated <strong>Compensation</strong> controls have been shipped with <strong>CytoExploreRData</strong> for demonstration purposes. This <em>in vitro</em> assay involves stimulating dendritic cells (DCs) with different immune stimulators (referred to as Stim-A, Stim-B, Stim-C and Stim-D) under increasing concentrations of the surrogate antigen ovalbumin (0 nM, 5 nM, 50 nM or 500 nM OVA). These activated DCs are then co-cultured with antigen-specific OT-I (CD8+) and OT-II (CD4+) T cells. The ability of each of the immune stimulators to promote T cell activation was then assessed by measuring the expression of T cell activation markers (CD44 and CD69) by flow cytometry.</p>
Although <strong>CytoExploreR</strong> has full support for automated gating through <strong>openCyto</strong>, for simplicity in this vignette we will describe a manual gating analysis pipeline to analyse this dataset.
</div>
<p><br></p>
</div>
<div id="set-up-new-r-project" class="section level1">
<h1 class="hasAnchor">
<a href="#set-up-new-r-project" class="anchor"></a>1. Set Up New R Project</h1>
<div style="line-height: 1.8em;">
<p>Before we begin, we will need to create a new R project by following these steps:</p>
<ul>
<li>Select File -&gt; New Project</li>
<li>Select New Directory -&gt; New Project</li>
<li>Set Directory Name to “CytoExploreR-Demo”</li>
<li>Indicate where the project should be created and select Create Project</li>
</ul>
</div>
<p><br></p>
</div>
<div id="load-required-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#load-required-packages" class="anchor"></a>2. Load Required Packages</h1>
<div style="line-height: 1.8em;">
<strong>CytoExploreR</strong> is closely integrated with the RGLab’s suite of cytometry packages, including <strong>flowCore</strong>, <strong>flowWorkspace</strong> and <strong>openCyto</strong>. This means that these packages will be automatically loaded when <strong>CytoExploreR</strong> is loaded and any functions from these packages are completely compatible with <strong>CytoExploreR</strong>. To demonstrate the features of <strong>CytoExploreR</strong> we will also need to load <strong>CytoExploreRData</strong> which contains the <strong>Compensation</strong> and <strong>Activation</strong> datasets.
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load required packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DillonHammill/CytoExploreR">CytoExploreR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CytoExploreRData</span><span class="op">)</span></code></pre></div>
<p><br></p>
</div>
<div id="save-fcs-files" class="section level1">
<h1 class="hasAnchor">
<a href="#save-fcs-files" class="anchor"></a>3. Save FCS Files</h1>
<div style="line-height: 1.8em;">
Users should create a new folder in the current working directory and add their FCS files into this folder. It is recommended that you store your compensation controls and samples in separate folders as these files will be analysed separately. The following snippet outlines the steps required to download FCS files for the <strong>Compensation</strong> and <strong>Activation</strong> datasets and save them to appropriately named folders in your current working directory.
</div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compensation FCS Files</span>
<span class="fu"><a href="../reference/cyto_save.html">cyto_save</a></span><span class="op">(</span><span class="va">Compensation</span>, 
          save_as <span class="op">=</span> <span class="st">"Compensation-Samples"</span><span class="op">)</span>

<span class="co"># Activation FCS Files</span>
<span class="fu"><a href="../reference/cyto_save.html">cyto_save</a></span><span class="op">(</span><span class="va">Activation</span>,
          save_as <span class="op">=</span> <span class="st">"Activation-Samples"</span><span class="op">)</span></code></pre></div>
<p><br></p>
</div>
<div id="compensation-of-fluorescent-spillover" class="section level1">
<h1 class="hasAnchor">
<a href="#compensation-of-fluorescent-spillover" class="anchor"></a>4. Compensation of Fluorescent Spillover</h1>
<div style="line-height: 1.8em;">
Flow cytometry users will need to compensate their data for fluorescent spillover prior to downstream analyses. The basic steps required to compute and refine the spillover matrix are outlined below. Refer to the Compensation vignette for a more details.
</div>
<div id="prepare-compensation-controls" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-compensation-controls" class="anchor"></a>4.1 Prepare compensation controls</h2>
<div style="line-height: 1.8em;">
The compensation controls can be loaded into a GatingSet by passing the name of the folder where the FCS files are saved to <code>cyto_setup</code>. At this stage it is also a good idea to setup a new gatingTemplate to record any downstream gating operations. Once the compensation controls have been loaded into a GatingSet, we need to transform the fluorescent channels using <code>cyto_transform</code>. The transformed data can then be gated using <code>cyto_gate_draw</code> to remove debris and doublets to ensure accurate computation of spillover values.
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Setup compensation controls</span>
<span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyto_setup.html">cyto_setup</a></span><span class="op">(</span><span class="st">"Compensation-Samples"</span>,
                 gatingTemplate <span class="op">=</span> <span class="st">"Compensation-gatingTemplate.csv"</span><span class="op">)</span>

<span class="co"># Transform fluorescent channels - default logicle transformations</span>
<span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyto_transform.html">cyto_transform</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span>

<span class="co"># Gate Cells</span>
<span class="fu"><a href="../reference/cyto_gate_draw.html">cyto_gate_draw</a></span><span class="op">(</span><span class="va">gs</span>,
               parent <span class="op">=</span> <span class="st">"root"</span>,
               alias <span class="op">=</span> <span class="st">"Cells"</span>,
               channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FSC-A"</span>, <span class="st">"SSC-A"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Gate Single Cells</span>
<span class="fu"><a href="../reference/cyto_gate_draw.html">cyto_gate_draw</a></span><span class="op">(</span><span class="va">gs</span>,
               parent <span class="op">=</span> <span class="st">"Cells"</span>,
               alias <span class="op">=</span> <span class="st">"Single Cells"</span>,
               channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FSC-A"</span>, <span class="st">"FSC-H"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-1.png" width="98%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
<div id="compute-spillover-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-spillover-matrix" class="anchor"></a>4.2 Compute Spillover Matrix</h2>
<div style="line-height: 1.8em;">
The spillover matrix can be automatically calculated using <code>cyto_spillover_compute</code>. Users are asked to assign a channel to compensation control and then gate the positive signal for each control in the indicated channel. <strong>CytoExploreR</strong> supports the use of either a universal unstained control or requires that each single colour control contain its own internal unstained reference population. The spillover matrix will be calculated using the method described by Bagwell &amp; Adams 1993.
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute spillover matrix</span>
<span class="va">spill</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyto_spillover_compute.html">cyto_spillover_compute</a></span><span class="op">(</span><span class="va">gs</span>,
                                parent <span class="op">=</span> <span class="st">"Single Cells"</span>,
                                spillover <span class="op">=</span> <span class="st">"Spillover-Matrix.csv"</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/Compensation/Compensation-9.png" width="98%" style="display: block; margin: auto;"></p>
</div>
<div id="edit-spillover-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#edit-spillover-matrix" class="anchor"></a>4.3 Edit Spillover Matrix</h2>
<div style="line-height: 1.8em;">
The computed spillover matrix can be interactively edited in realtime using <code>cyto_spillover_edit</code>. Users should refer to the <strong>Plots</strong> to identify any lingering compensation issues and return to the <strong>Editor</strong> tab to refine the spillover matrix. By definition, the data is correctly compensated when the MedFI of the stained control is equal to that of the reference unstained control in all secondary detectors. The updated spillover matrix will be saved to a CSV file for downstream use.
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Edit spillover matrix</span>
<span class="va">spill</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyto_spillover_edit.html">cyto_spillover_edit</a></span><span class="op">(</span><span class="va">gs</span>,
                             parent <span class="op">=</span> <span class="st">"Single Cells"</span>,
                             spillover <span class="op">=</span> <span class="st">"Spillover-Matrix.csv"</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/Compensation/Compensation-10.png" width="98%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
<div id="visualise-compensation" class="section level2">
<h2 class="hasAnchor">
<a href="#visualise-compensation" class="anchor"></a>4.4 Visualise Compensation</h2>
<div style="line-height: 1.8em;">
After editing the spillover matrix manually, it is a good idea to check that all compensation issues have been addressed. The easiest way to do this without having to launch the spillover matrix editor is through <code>cyto_plot_compensation</code>. <code>cyto_plot_compensation</code> will plot uncompensated and compensated data in all fluorescent channels to check the compensation. The unstained control will automatically be overlaid onto the plots as a reference if supplied.
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Visualise uncompensated data</span>
<span class="fu"><a href="../reference/cyto_plot_compensation.html">cyto_plot_compensation</a></span><span class="op">(</span><span class="va">gs</span>,
                       parent <span class="op">=</span> <span class="st">"Single Cells"</span><span class="op">)</span>

<span class="co"># Visualise compensated data</span>
<span class="fu"><a href="../reference/cyto_plot_compensation.html">cyto_plot_compensation</a></span><span class="op">(</span><span class="va">gs</span>,
                       parent <span class="op">=</span> <span class="st">"Single Cells"</span>,
                       spillover <span class="op">=</span> <span class="st">"Spillover-Matrix.csv"</span>,
                       compensate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/Compensation/Compensation-14.png" width="98%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
</div>
<div id="analyse-samples" class="section level1">
<h1 class="hasAnchor">
<a href="#analyse-samples" class="anchor"></a>5. Analyse Samples</h1>
<div style="line-height: 1.8em;">
Once we have finalised the spillover matrix, we are done with our compensation controls and can now move on to analysing our samples. The steps involved in this process are outlined below.
</div>
<div id="load-and-annotate-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#load-and-annotate-samples" class="anchor"></a>5.1 Load and Annotate Samples</h2>
<div style="line-height: 1.8em;">
To load the samples directly into a GatingSet and annotate them with experimental details, we use <code>cyto_setup</code>. This function will open inteactive table editors to allow entry of experimenta markers and experiment details. For the purpose of demonstration, the details of this experiment have already been added.
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load and annotate samples</span>
<span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyto_setup.html">cyto_setup</a></span><span class="op">(</span><span class="st">"Activation-Samples"</span>,
                 gatingTemplate <span class="op">=</span> <span class="st">"Activation-gatingTemplate.csv"</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-2.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div id="apply-compensation-and-data-transformations" class="section level2">
<h2 class="hasAnchor">
<a href="#apply-compensation-and-data-transformations" class="anchor"></a>5.2 Apply Compensation and Data Transformations</h2>
<div style="line-height: 1.8em;">
Since the data is always imported uncompensated and on a linear scale, we will need to apply our spillover matrix and transform the fluorescent channels to appropriately visualise the data. We can apply our spillover matrix to the samples using <code>cyto_compensate</code> and transform the fluorescent channels using <code>cyto_transform</code>. It is important that data compensation and transformations occur in this order as compensation must be applied to linear data only.
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Apply compensation</span>
<span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyto_compensate.html">cyto_compensate</a></span><span class="op">(</span><span class="va">gs</span>,
                      spillover <span class="op">=</span> <span class="st">"Spillover-Matrix.csv"</span><span class="op">)</span>

<span class="co"># Transform fluorescent channels - default logicle transformations</span>
<span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyto_transform.html">cyto_transform</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-3.png" width="98%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
<div id="gate-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#gate-samples" class="anchor"></a>5.3 Gate Samples</h2>
<div style="line-height: 1.8em;">
Now that the data has been properly prepared, it’s time to manually gate populations using <code>cyto_gate_draw</code>. This function allows us to interactively draw gates around populations using a variety of useful gate types. Let’s begin by drawing a polygon gate around the leukocyte population using the FSC-A and SSC-A parameteres. Since polygon gates are the default ate type for 2D plots, we don’t need to specify the gate type through the <code>type</code> argument. Polygon gates can be closed by right clicking and selecting “stop”.
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Gate Cells</span>
<span class="fu"><a href="../reference/cyto_gate_draw.html">cyto_gate_draw</a></span><span class="op">(</span><span class="va">gs</span>,
               parent <span class="op">=</span> <span class="st">"root"</span>,
               alias <span class="op">=</span> <span class="st">"Cells"</span>,
               channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FSC-A"</span>,<span class="st">"SSC-A"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-4.png" width="60%" style="display: block; margin: auto;"></p>
<div style="line-height: 1.8em;">
Constructing new gates is as simple as copying and editing the above code. Now let’s gate the single cells within the cells population by drawing a polygon gate using the FSC-A and FSC-H parameters.
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Gate Single Cells</span>
<span class="fu"><a href="../reference/cyto_gate_draw.html">cyto_gate_draw</a></span><span class="op">(</span><span class="va">gs</span>,
               parent <span class="op">=</span> <span class="st">"Cells"</span>,
               alias <span class="op">=</span> <span class="st">"Single Cells"</span>,
               channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FSC-A"</span>,<span class="st">"FSC-H"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-5.png" width="60%" style="display: block; margin: auto;"></p>
<div style="line-height: 1.8em;">
As with any other function in <strong>CytoExploreR</strong> that generates plots, <code>cyto_gate_draw</code> makes use of <code>cyto_plot</code> to visualise the data. This means that we can pass any <code>cyto_plot</code> arguments through <code>cyto_gate_draw</code> to modify the constructed plots. This allows us to pull out samples or populations and overlay them on the plot to help us decide where the gate(s) should be set. As an examples, below we have extracted the unstained control and overlaid it onto the plot so that we can better set our live and dead cells gates. Notice how <strong>CytoExploreR</strong> supports gate negation through the <code>negate</code> argument. This means that any events outside the dead cells gate will be classified as live cells without the need for drawing additional gates. To construct the rectangle gate simply select the two diagonal points that encompass the population.
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extract unstained control </span>
<span class="va">NIL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyto_extract.html">cyto_extract</a></span><span class="op">(</span><span class="va">gs</span>, <span class="st">"Single Cells"</span><span class="op">)</span><span class="op">[[</span><span class="fl">33</span><span class="op">]</span><span class="op">]</span>

<span class="co"># Gate Live Cells</span>
<span class="fu"><a href="../reference/cyto_gate_draw.html">cyto_gate_draw</a></span><span class="op">(</span><span class="va">gs</span>,
               parent <span class="op">=</span> <span class="st">"Single Cells"</span>,
               alias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dead Cells"</span>, <span class="st">"Live Cells"</span><span class="op">)</span>,
               channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hoechst-405"</span>, <span class="st">"Hoechst-430"</span><span class="op">)</span>,
               type <span class="op">=</span> <span class="st">"rectangle"</span>,
               negate <span class="op">=</span> <span class="cn">TRUE</span>,
               overlay <span class="op">=</span> <span class="va">NIL</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-6.png" width="60%" style="display: block; margin: auto;"></p>
<div style="line-height: 1.8em;">
<code>cyto_gate_draw</code> also has support for mixed gate type when gating multiplpe populations. For example, we could use an ellipsoid gate for the T cells population and a rectangle gate for the dendritic cells populations.
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Gate T Cells and Dedritic Cells</span>
<span class="fu"><a href="../reference/cyto_gate_draw.html">cyto_gate_draw</a></span><span class="op">(</span><span class="va">gs</span>,
               parent <span class="op">=</span> <span class="st">"Live Cells"</span>,
               alias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T Cells"</span>, <span class="st">"Dendritic Cells"</span><span class="op">)</span>,
               channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD11c"</span>, <span class="st">"Va2"</span><span class="op">)</span>,
               type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ellipse"</span>, <span class="st">"rectangle"</span><span class="op">)</span>,
               overlay <span class="op">=</span> <span class="va">NIL</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-7.png" width="60%" style="display: block; margin: auto;"></p>
<div style="line-height: 1.8em;">
Next we will gate the CD4 and CD8 T cells using rectangle gates.
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Gate CD4 &amp; CD8 T Cells</span>
<span class="fu"><a href="../reference/cyto_gate_draw.html">cyto_gate_draw</a></span><span class="op">(</span><span class="va">gs</span>,
               parent <span class="op">=</span> <span class="st">"T Cells"</span>,
               alias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD4 T Cells"</span>, <span class="st">"CD8 T Cells"</span><span class="op">)</span>,
               channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD4"</span>, <span class="st">"CD8"</span><span class="op">)</span>,
               type <span class="op">=</span> <span class="st">"r"</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-8.png" width="60%" style="display: block; margin: auto;"></p>
<div style="line-height: 1.8em;">
In our last couple of gates, we want to gate our activated CD69+ CD4 and CD8 T cells. For the CD4 T cells we will extract the samples which contain unactivated T cells (i.e. received to antigen) and overlay these onto the plot to make it easier to set the gate.
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extract CD4 T Cells</span>
<span class="va">CD4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyto_extract.html">cyto_extract</a></span><span class="op">(</span><span class="va">gs</span>, <span class="st">"CD4 T Cells"</span><span class="op">)</span>

<span class="co"># Extract naive CD4 T Cells</span>
<span class="va">CD4_naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cyto_select.html">cyto_select</a></span><span class="op">(</span><span class="va">CD4</span>, OVAConc <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co"># Gate CD69+ CD4 T Cells</span>
<span class="fu"><a href="../reference/cyto_gate_draw.html">cyto_gate_draw</a></span><span class="op">(</span><span class="va">gs</span>,
               parent <span class="op">=</span> <span class="st">"CD4 T Cells"</span>,
               alias <span class="op">=</span> <span class="st">"CD69+ CD4 T Cells"</span>,
               channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD44"</span>, <span class="st">"CD69"</span><span class="op">)</span>,
               type <span class="op">=</span> <span class="st">"rectangle"</span>,
               overlay <span class="op">=</span> <span class="va">CD4_naive</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-9.png" width="60%" style="display: block; margin: auto;"></p>
<div style="line-height: 1.8em;">
Adding contour lines to the plot can also be helpful in deciding where gates should be set. Let’s add some onto the CD8 T cells so we can set the CD69+ gate.
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Gate CD69+ CD8 T Cells</span>
<span class="fu"><a href="../reference/cyto_gate_draw.html">cyto_gate_draw</a></span><span class="op">(</span><span class="va">gs</span>,
               parent <span class="op">=</span> <span class="st">"CD8 T Cells"</span>,
               alias <span class="op">=</span> <span class="st">"CD69+ CD8 T Cells"</span>,
               channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD44"</span>, <span class="st">"CD69"</span><span class="op">)</span>,
               type <span class="op">=</span> <span class="st">"rectangle"</span>,
               contour_lines <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-10.png" width="60%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
</div>
<div id="explore-gated-samples" class="section level1">
<h1 class="hasAnchor">
<a href="#explore-gated-samples" class="anchor"></a>5.4 Explore Gated Samples</h1>
<div style="line-height: 1.8em;">
<strong>CytoExploreR</strong> has a variety of visualisation tools to explore gated data. One of my personal favourites is <code>cyto_plot_gating_tree</code>. This function plots the gating tree with nodes scaled by population size and can also display frequency and count statistics for each node. Since <code>cyto_plot_gating_tree</code> doesn’t plot the actual data it is super fast and provides a quick overview of the data. It is also completely interactive! Try clicking and dragging nodes, it’s loads of fun!
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Gating Tree</span>
<span class="fu"><a href="../reference/cyto_plot_gating_tree.html">cyto_plot_gating_tree</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[[</span><span class="fl">32</span><span class="op">]</span><span class="op">]</span>,
                      stat <span class="op">=</span> <span class="st">"freq"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-41f9311f6d7689b28590" style="width:100%;height:432.632880098888px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-41f9311f6d7689b28590">{"x":{"nodes":{"id":["root","Cells","Single Cells","Live Cells","Dendritic Cells","T Cells","CD4 T Cells","CD69+ CD4 T Cells","CD8 T Cells","CD69+ CD8 T Cells","Dead Cells"],"label":["root","Cells","Single Cells","Live Cells","Dendritic Cells","T Cells","CD4 T Cells","CD69+ CD4 T Cells","CD8 T Cells","CD69+ CD8 T Cells","Dead Cells"],"group":["root","Cells","Single Cells","Live Cells","Dendritic Cells","T Cells","CD4 T Cells","CD69+ CD4 T Cells","CD8 T Cells","CD69+ CD8 T Cells","Dead Cells"],"value":[1,0.6466,0.58924,0.35244,0.01968,0.12822,0.04028,0.00904,0.07594,0.00832,0.2368]},"edges":{"to":["Cells","Single Cells","Live Cells","Dendritic Cells","T Cells","CD4 T Cells","CD69+ CD4 T Cells","CD8 T Cells","CD69+ CD8 T Cells","Dead Cells"],"from":["root","Cells","Single Cells","Live Cells","Live Cells","T Cells","CD4 T Cells","T Cells","CD8 T Cells","Single Cells"],"label":["64.66 %","91.13 %","59.81 %","5.58 %","36.38 %","31.41 %","22.44 %","59.23 %","10.96 %","40.19 %"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to","color":"black"}},"groups":["root","Cells","Single Cells","Live Cells","Dendritic Cells","T Cells","CD4 T Cells","CD69+ CD4 T Cells","CD8 T Cells","CD69+ CD8 T Cells","Dead Cells"],"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script><div style="line-height: 1.8em;">
It is also easy to plot entire gating schemes using <code>cyto_plot_gating_scheme</code>. This is an extremely powerful function that can plot gating schemes for all samples, and has full support for back gating and gate tracking.
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Gating scheme</span>
<span class="fu"><a href="../reference/cyto_plot_gating_scheme.html">cyto_plot_gating_scheme</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[</span><span class="fl">32</span><span class="op">]</span>,
                        back_gate <span class="op">=</span> <span class="cn">TRUE</span>,
                        gate_track <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="../../../R%20Projects/CytoExploreR-master/vignettes/CytoExploreR/CytoExploreR-11.png" width="98%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
<div id="export-statistics" class="section level1">
<h1 class="hasAnchor">
<a href="#export-statistics" class="anchor"></a>5.5 Export Statistics</h1>
<div style="line-height: 1.8em;">
At the end of any analysis pipeline, we want to export population-level statistics for reporting. This is easily acheived using <code>cyto_stats_compute</code> which will compute the desired statistics for the specified populations and return a tidyverse friendly output that retains all the experiment details. This makes it easy to plot the exported statistics using other R packages, such as ggplot2.
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute medFI - exclude unstained control</span>
<span class="fu"><a href="../reference/cyto_stats_compute.html">cyto_stats_compute</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">32</span><span class="op">]</span>,
                   alias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD69+ CD4 T Cells"</span>,
                             <span class="st">"CD69+ CD8 T Cells"</span><span class="op">)</span>,
                   stat <span class="op">=</span> <span class="st">"median"</span>,
                   channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD44"</span>, <span class="st">"CD69"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 128 x 6</span>
<span class="co">#&gt;    name             OVAConc Treatment Population        Marker  MedFI</span>
<span class="co">#&gt;    &lt;fct&gt;            &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;             &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Activation_1.fcs 0       Stim-A    CD69+ CD4 T Cells CD44   18695.</span>
<span class="co">#&gt;  2 Activation_1.fcs 0       Stim-A    CD69+ CD8 T Cells CD44    3523.</span>
<span class="co">#&gt;  3 Activation_1.fcs 0       Stim-A    CD69+ CD4 T Cells CD69    4315.</span>
<span class="co">#&gt;  4 Activation_1.fcs 0       Stim-A    CD69+ CD8 T Cells CD69    2579.</span>
<span class="co">#&gt;  5 Activation_2.fcs 0       Stim-A    CD69+ CD4 T Cells CD44   13892.</span>
<span class="co">#&gt;  6 Activation_2.fcs 0       Stim-A    CD69+ CD8 T Cells CD44    2559.</span>
<span class="co">#&gt;  7 Activation_2.fcs 0       Stim-A    CD69+ CD4 T Cells CD69    4298.</span>
<span class="co">#&gt;  8 Activation_2.fcs 0       Stim-A    CD69+ CD8 T Cells CD69    2783.</span>
<span class="co">#&gt;  9 Activation_3.fcs 5       Stim-A    CD69+ CD4 T Cells CD44   15815.</span>
<span class="co">#&gt; 10 Activation_3.fcs 5       Stim-A    CD69+ CD8 T Cells CD44    2826.</span>
<span class="co">#&gt; # ... with 118 more rows</span></code></pre></div>
<p><br></p>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>6. Summary</h1>
<div style="line-height: 1.8em;">
<strong>CytoExploreR</strong> is a feature packed R package that contains all the tools necessary to analyse your cytometry data. The purpose of this vignette was simply to introduce some of the key features of the package, and to highlight how easy it is to use. It is impossible to include all the feaures of the package in this vignette, so I recommend that you explore the other package vignettes which explore each of these components in a lot more detail.
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Dillon Hammill.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
